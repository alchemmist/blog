---
date: 2025-02-02
title: "Очистка диска в Linux"
tech_name: "linux-clean-up"
language: ru
tags:
  - linux
extra:
  custom_props:
    time: 14:18
    public: true
    type: synopsis
    theme: linux
    status: finished
---
Если вы используете Docker, хорошее начало — очистка связанных с ним данных (только если уверены, что контейнеры и тома не содержат важного):
```sh
docker system prune
```

## 1. Очистка пакетов
Советы для Arch-систем:

Поиск самых тяжёлых пакетов (топ-20):
```sh
pacman -Qi | awk '/^Name/{name=$3} /^Installed Size/{print $4 $5, name}' | sort -hr | head -n 20
```

Поиск неиспользуемых зависимостей:
```sh
pacman -Qdtq
```

**Внимание!** В этом списке могут быть важные пакеты, которые просто никто не использует в данный момент.

Удаление неиспользуемых зависимостей (если уверены):
```sh
sudo pacman -Rns $(pacman -Qdtq)
```

Поиск забытых пакетов (топ-20 давно неиспользуемых):
```sh
expac --timefmt='%Y-%m-%d %T' '%l %n' | sort | head -n 20
```

Очистка кэша `pacman` (сохраняет текущую и предыдущую версии пакетов):
```sh
sudo paccache -r
```

Полная очистка кэша (оставляет только установленные версии):
```sh
sudo paccache -r -k 0
```
Помните: после этого вы не сможете откатить пакеты без интернета.

## 2. Очистка файлов
Топ-15 самых тяжёлых директорий в домашнем каталоге:
```sh
du -h ~/ --max-depth=1 | sort -hr | head -n 15
```

Топ-20 самых тяжёлых файлов в домашнем каталоге:
```sh
find ~/ -type f -exec du -Sh {} + | sort -rh | head -n 20
```

Этих двух команд обычно достаточно для поиска точек очистки. Можно перейти в тяжёлую директорию и повторить команду внутри неё.```